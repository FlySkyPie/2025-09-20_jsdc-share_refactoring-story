# 2 - Summary

我今天會分享的性質比較接近說故事，技術含量可能比較不高，在這邊先打個預防針，避免有人聽完覺得有點失望。

今天我要分享三個重構的專案，各位可以當作是三個故事。

那麼重構的故事究竟是從哪裡開始的呢？

# 3 - Awesome Open Source

我的興趣就是去 Awesome Open Source 這種網站閒逛，看有沒有什麼有趣的專案，有些我會先放在口袋清單，如果哪天突然哪根筋不對勁就去 clone 下來玩玩。

順便說一下，我的風格就是在「投影片」裡面的參考來源通常會附上 QR Code，有興趣的人可以自己拿出手機掃描。

# 4

當然，GitHub 的主題專區也是一個好地方。

# 5

第一個專案的名稱有點長，我先叫它糖果戰記。
它是一個 2D 的射擊小遊戲。
這算是第一個我正式開始翻別人專案重構的專案，而這個專案背後有一個小故事。

# 6

這個專案源自一個叫做 CandyJam 的 Game Jam，我簡單解釋一下，以免有人不知道 Game Jam 是什麼。Game Jam 就是一群人組隊在有限的時間內，比如一天不睡覺，把一個小遊戲做出來的活動，有點類似黑客松。

# 7

Candy Crush 這個遊戲大家應該多少都聽過，而它背後的公司當時企圖對 Candy 這個詞彙申請註冊商標。

# 8

並且這間公司還對另外一個獨立開發者發起告訴，因為那個獨立遊戲使用了 Saga 這個單字。

# 9

於是獨立開發圈就發起一個名為 CandyJam 的 GameJam，直接嘲諷與挑興那間公司。

# 10

所以你可以看到這個專案的名稱就是用好用滿，又有 Candy，也有 Saga。

# 11

具體而言我究竟重構了什麼？
我把 Javascript 的程式碼遷移成 Typescript 專案，
並且把 Phaser 引擎從第二版升級到第三版。

# 12

接下來是名為 Aim And Shoot 的專案。
各位可以看到它的封面圖非常有個性。

# 13

這個專案同樣是 2D 射擊遊戲，
不過比較特別是玩家是中間這個黑色的，
而其他敵人全部都是由一個簡陋的類神經網路所控制。

# 14

並且當玩家死亡時會出現這個畫面嘲諷玩家。

# 15

至於我在這個專案重構了什麼？

# 16

Readme 有寫，自己看。

# 17

開個小玩笑，我這邊簡單解釋一下。

# 18

還是老樣子的把 Javascript 移植到 Typescript，
另外就是加入現代化的工具鏈，因為原本的專案並沒有使用 ES Module。

# 19

另外就是簡單寫了個美化的 UI 顯示記分板，
並且試著使用 Web Component，
整個遊戲實做和中間 Canvas 的部份是被封裝成 Web Component，外面再用 React 拉進來使用。

# 20

還有一個比較特別的事，也是我這次專案主要的目的，
就是練習 ECS 的寫法。
ECS 是相對於物件導向的另外一種程式設計風格，
簡單來說就是 OOP 會把資料跟運算封裝成物件，
但是 ECS 則是採用資料跟運算分開來的寫作方式，
資料會以 Entity 和 Component 的形式存在，運算則是由 System 負責。

因為這種差異，寫成是的時候必須要訓練自己不要以 OOP 的思維去思考問題，所以我算是透過這個重構的專案想要體驗一下 ECS 的思考方式。

# 21

接著，下一個專案的故事有一點點複雜。
故事是從我在 GitHub 上發現有人逆向工程少女前線的遊戲內容。

# 22

在這個資料夾裡面

# 23

可以找到像是這樣的東西，也就是遊戲角色的素材。

# 24

不過問題是這個檔案格式是由這個專有軟體所有。

# 25

並且所有 runtime 都受到嚴格的授權規則限制，
簡單來說，想用就要付錢。

# 26

於是我後來找到另外一款叫做 DragonBones 的軟體，
它的編輯器本身之前是免費下載的。

# 27

而 runtime，俗稱 SDK。

# 28

是開源的！

# 29

並且支援我熟悉的 Three.js。

# 30

但是問題來了，這是 Pixi 的範例程式。

# 31

這是 Three.js 的範例程式。

# 32

我重構的重點主要有兩個，
一個是把原本基於 namespace 的 bundle 拆成 ES Module。
另外一個是把 Three.js 升級到當時的最新版本。
但是問題就來了，我要怎麼知道我重構的過程有沒有不小心弄壞東西？
剛剛各位有看到 Pixi 的 runtime 有很多範例，
加上專案老舊歸老舊，但是結構切得很漂亮，可以透過一個抽象層讓不同的目標函式庫共用同一組核心程式碼。

所以我最後總共重構了三個模組，核心模組、Three.js 模組和 Pixi，Three.js 和核心模組是我實際要用到的， Pixi 模組是為了給範例程式執行用來測試我重構的核心模組有沒有問題。

# 33

花了一個月重構完成後我終於才能開始寫我最一開始想測試的東西，就是一個簡單的射擊遊戲。

# 34

好了，我分享了三個重構專案的故事，有人可能發現這三個專案之間好像有某種共同點。

不過又是另外一個故事了。

# 35

有人說「不要聽一個人說什麼，要看一個人做了什麼」。
所以我把自我介紹放在最後，各位不需要知道我是誰，只要知道我做了什麼。

我是飛派，主要網頁前端工程師，只是因為公司的業務是偏遊戲開發屬性的，所以我有比較有機會接觸 3D 美術相關的東西，貼圖啦、頂點啦、渲染什麼的算是略懂略懂。

# 36

然後如各位所見，我很愛挖新坑給自己跳。

# 37

我的分享到這裡為止。
包含這個投影片在內，跟我剛剛提到的專案的 Git Repo 都在上面。有人有問題嗎？
